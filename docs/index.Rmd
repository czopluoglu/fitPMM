---
title: Fitting a finite mixture of piecewise mixed-effect models with unknown random knots
subtitle:
author:
  name: Cengiz Zopluoglu
  affiliation: University of Oregon
date: 09/5/2024
output: 
  html_document:
    keep_md: false
    theme: journal
    highlight: haddock
    code_folding: show
    toc: yes
    toc_depth: 4
    toc_float: yes
always_allow_html: true
urlcolor: blue
mainfont: cochineal
sansfont: Fira Sans
monofont: Fira Code ## Although, see: https://tex.stackexchange.com/q/294362

## Automatically knit to both formats:
knit: (function(inputFile, encoding) {
 rmarkdown::render(inputFile, encoding = encoding, 
 output_format = 'all') 
 })
---

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(position=c('top','right'),color='#33C1FF')
```


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    z-index: 2;
    color: #fff;
    background-color: #33C1FF;
    border-color: #97CAEF;
}

</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = "",fig.align='center',message = FALSE,warning = FALSE)
require(here)
require(ggplot2)
require(plot3D)
require(kableExtra)
require(knitr)
require(giski)
require(magick)
options(scipen=99)

```

`r paste('[Updated:',format(Sys.time(),'%a, %b %d, %Y - %H:%M:%S'),']')`

<font color="black">

# Installing and loading support libraries and source files

This tutorial demonstrates how to fit the model described in the paper using the R routine we wrote. This routine can be found under the [[/code](https://github.com/czopluoglu/fitPMM/tree/main/code) folder in the associated [GitHub repository](https://github.com/czopluoglu/fitPMM). 

1) Please download the R routine directly from the following link to a local folder in your computer.

[https://raw.githubusercontent.com/czopluoglu/fitPMM/main/code/fitPMM.R](https://raw.githubusercontent.com/czopluoglu/fitPMM/main/code/fitPMM.R)

After you download the file, load it to your R working environment by using the `source()` function. 

```{r}
source(here('code/fitPMM.R'))
```

2) Then, you will also need to load a number of R packages as the R routine depends on some functions from these R packages. If you don't have these packages, first intall them, and then load them all in your R environment.

```{r}
	# install.packages("segmented",dependencies=TRUE)
	# install.packages("glmmML",dependencies=TRUE)
	# install.packages("MCMCpack",dependencies=TRUE)
	# install.packages("psych",dependencies=TRUE)
	# install.packages("MBESS",dependencies=TRUE)
	# install.packages("gdata",dependencies=TRUE)

	require(segmented)   # Fitting piecewise model to individual data, used to obtain start values
	require(glmmML)      # Using "ghq()" function
	require(MCMCpack)    # Using "xpnd()" function        
	require(psych)       # Using "cor.smooth()" function
	require(MBESS)       # Using "cor2cov()" function
	require(gdata)       # Using "write.fwf()" function

```


</font>


